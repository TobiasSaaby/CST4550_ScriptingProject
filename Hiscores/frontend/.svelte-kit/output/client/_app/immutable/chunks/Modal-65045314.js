import{O as D,S as R,i as F,s as q,k as _,l as v,m as g,h as p,n as z,b as k,N as T,Z as j,o as K,a as y,q as N,c as w,r as I,L as f,u as G,Q as S,V as L,_ as Q,$ as W,W as A,X as C,Y as B,f as O,t as V,T as X,a0 as Y,I as Z}from"./singletons-3d7ee568.js";import{p as $}from"./stores-e7e2dc20.js";import{e as J}from"./env-public-6aa99648.js";const pt=D(""),mt=D();var b=(n=>(n[n.Started=0]="Started",n[n.Running=1]="Running",n[n.Initialising=2]="Initialising",n[n.Finished=3]="Finished",n))(b||{});const _t=J.PUBLIC_API_URL||"http://localhost:8080",H=J.PUBLIC_HOST_URL||"http://localhost:8080",P=n=>{switch(n){case b.Started:return"yellow";case b.Running:return"black";case b.Initialising:return"blue";case b.Finished:return"green"}return"red"};let E=40;const vt=(n,t)=>{let a=document.createElement("div");return a.innerHTML=M(n,t),a},M=(n,t)=>{switch(n){case 0:return tt(E,E,P(t));case 1:return et(E,E,P(t));case 2:return x(E,E,P(t));default:return""}},x=(n,t,a)=>`<svg style="height: ${n}px; width: ${t};" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 0h512v512H0z" fill="#000000" fill-opacity="0.02"></path><g class="" style="" transform="translate(0,0)"><path d="M41 25v78h430V25H41zm254 23h18v32h-18V48zm121 0a16 16 0 0 1 16 16 16 16 0 0 1-16 16 16 16 0 0 1-16-16 16 16 0 0 1 16-16zM64 55h48v18H64V55zm80 0h48v18h-48V55zm80 0h48v18h-48V55zm-119 66v30h302v-30H105zm-64 48v78h430v-78H41zm254 23h18v32h-18v-32zm121 0a16 16 0 0 1 16 16 16 16 0 0 1-16 16 16 16 0 0 1-16-16 16 16 0 0 1 16-16zm-352 7h48v18H64v-18zm80 0h48v18h-48v-18zm80 0h48v18h-48v-18zm-119 66v30h302v-30H105zm-64 48v78h430v-78H41zm254 23h18v32h-18v-32zm121 0a16 16 0 0 1 16 16 16 16 0 0 1-16 16 16 16 0 0 1-16-16 16 16 0 0 1 16-16zm-352 7h48v18H64v-18zm80 0h48v18h-48v-18zm80 0h48v18h-48v-18zm13 66v30h38v-30h-38zM25 457v30h130.2l20-30H25zm171.8 0l-20 30h158.4l-20-30H196.8zm140 0l20 30H487v-30H336.8z" fill=${a} fill-opacity="1"></path></g></svg>`,tt=(n,t,a)=>`<svg style="height: ${n}px; width: ${t};" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g class="" style="" transform="translate(0,0)"><path d="M257.78 19.438c-127.92.016-231.75 103.855-231.75 231.78 0 55.734 19.71 106.776 52.532 146.72L57.75 434.094h132.406l-66.312-114.72-22.375 39c-20.9-30.478-33.064-67.442-33.064-107.155 0-104.523 84.854-189.376 189.375-189.376 104.523 0 189.408 84.853 189.408 189.375 0 39.108-11.68 75.664-32 105.874l-21.875-37.72L327 434.095h132.406l-21.594-37.47c32.225-39.78 51.75-90.253 51.75-145.405 0-127.927-103.827-231.766-231.75-231.782h-.03zm-.655 75.468c-49.528-.047-110.474 29.232-128.406 104.938l60.75 14.312c26.965-76.242 90.87-70.824 113.31-28.625 26.775 50.346-89.687 107.283-84.124 190.407h77.688c6.49-98.144 118.973-123.49 59.562-229.53C337.963 114.38 301 96.572 261.876 95.03V95c-1.573-.062-3.153-.092-4.75-.094zM258.5 395.97c-26.95 0-48.594 21.644-48.594 48.592 0 26.95 21.645 48.594 48.594 48.594 26.95 0 48.594-21.645 48.594-48.594 0-26.948-21.645-48.593-48.594-48.593z" fill=${a} fill-opacity="1"></path></g></svg>`,et=(n,t,a)=>`<svg style="height: ${n}px; width: ${t};" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g class="" style="" transform="translate(0,0)"><path d="M157.705 400.355h193.09v17.53h-193.09v-17.53zm180.8-17.53h-165v-96.82a53.29 53.29 0 0 1 53.29-53.29h58.43a53.29 53.29 0 0 1 53.28 53.29v96.79zm-106.64-135.77h-10.44a37.83 37.83 0 0 0-37.83 37.83v77.22h48.27v-115zm-197 79.59h103.58v-17.53H34.875v17.53zm137.41-107.9l-73.22-73.23-12.4 12.4 73.23 73.23zm92.5-124.63h-17.54v103.57h17.53V94.115zm149 51.39l-73.23 73.23 12.4 12.4 73.23-73.23zm-40.18 163.6v17.53h103.54v-17.52h-103.57z" fill=${a} fill-opacity="1"></path></g></svg>`;function st(n){let t,a,o,e,l,i,d,r,m;return{c(){t=_("button"),a=_("span"),o=y(),e=_("span"),l=y(),i=_("span"),d=y(),r=_("span"),m=N(`
			Loading...`),this.h()},l(c){t=v(c,"BUTTON",{class:!0});var s=g(t);a=v(s,"SPAN",{class:!0}),g(a).forEach(p),o=w(s),e=v(s,"SPAN",{class:!0}),g(e).forEach(p),l=w(s),i=v(s,"SPAN",{class:!0}),g(i).forEach(p),d=w(s),r=v(s,"SPAN",{class:!0}),g(r).forEach(p),m=I(s,`
			Loading...`),s.forEach(p),this.h()},h(){z(a,"class","svelte-1uo0zfy"),z(e,"class","svelte-1uo0zfy"),z(i,"class","svelte-1uo0zfy"),z(r,"class","svelte-1uo0zfy"),z(t,"class","svelte-1uo0zfy")},m(c,s){k(c,t,s),f(t,a),f(t,o),f(t,e),f(t,l),f(t,i),f(t,d),f(t,r),f(t,m)},p:T,d(c){c&&p(t)}}}function at(n){let t;return{c(){t=N(n[1])},l(a){t=I(a,n[1])},m(a,o){k(a,t,o)},p(a,o){o&2&&G(t,a[1])},d(a){a&&p(t)}}}function nt(n){let t,a,o,e,l,i,d,r,m,c,s;return{c(){t=_("button"),a=_("span"),o=y(),e=_("span"),l=y(),i=_("span"),d=y(),r=_("span"),m=N(`
			Terminate CTF`),this.h()},l(u){t=v(u,"BUTTON",{class:!0});var h=g(t);a=v(h,"SPAN",{class:!0}),g(a).forEach(p),o=w(h),e=v(h,"SPAN",{class:!0}),g(e).forEach(p),l=w(h),i=v(h,"SPAN",{class:!0}),g(i).forEach(p),d=w(h),r=v(h,"SPAN",{class:!0}),g(r).forEach(p),m=I(h,`
			Terminate CTF`),h.forEach(p),this.h()},h(){z(a,"class","svelte-1uo0zfy"),z(e,"class","svelte-1uo0zfy"),z(i,"class","svelte-1uo0zfy"),z(r,"class","svelte-1uo0zfy"),z(t,"class","svelte-1uo0zfy")},m(u,h){k(u,t,h),f(t,a),f(t,o),f(t,e),f(t,l),f(t,i),f(t,d),f(t,r),f(t,m),c||(s=S(t,"click",n[5]),c=!0)},p:T,d(u){u&&p(t),c=!1,s()}}}function lt(n){let t,a,o,e,l,i,d,r,m,c,s;return{c(){t=_("button"),a=_("span"),o=y(),e=_("span"),l=y(),i=_("span"),d=y(),r=_("span"),m=N(`
			Initialize CTF`),this.h()},l(u){t=v(u,"BUTTON",{class:!0});var h=g(t);a=v(h,"SPAN",{class:!0}),g(a).forEach(p),o=w(h),e=v(h,"SPAN",{class:!0}),g(e).forEach(p),l=w(h),i=v(h,"SPAN",{class:!0}),g(i).forEach(p),d=w(h),r=v(h,"SPAN",{class:!0}),g(r).forEach(p),m=I(h,`
			Initialize CTF`),h.forEach(p),this.h()},h(){z(a,"class","svelte-1uo0zfy"),z(e,"class","svelte-1uo0zfy"),z(i,"class","svelte-1uo0zfy"),z(r,"class","svelte-1uo0zfy"),z(t,"class","svelte-1uo0zfy")},m(u,h){k(u,t,h),f(t,a),f(t,o),f(t,e),f(t,l),f(t,i),f(t,d),f(t,r),f(t,m),c||(s=S(t,"click",n[4]),c=!0)},p:T,d(u){u&&p(t),c=!1,s()}}}function it(n){let t;function a(l,i){var d;return!((d=l[0])!=null&&d.state)||!l[0].state.instanceid?lt:l[0].state.ip?nt:l[1]?at:st}let o=a(n),e=o(n);return{c(){t=_("div"),e.c(),this.h()},l(l){t=v(l,"DIV",{class:!0});var i=g(t);e.l(i),i.forEach(p),this.h()},h(){z(t,"class","form svelte-1uo0zfy")},m(l,i){k(l,t,i),e.m(t,null)},p(l,[i]){o===(o=a(l))&&e?e.p(l,i):(e.d(1),e=o(l),e&&(e.c(),e.m(t,null)))},i:T,o:T,d(l){l&&p(t),e.d()}}}function rt(n,t,a){let o;j(n,$,s=>a(6,o=s));let{challenge:e}=t,l="";K(()=>{var s;(s=e==null?void 0:e.state)!=null&&s.instanceid&&d()});const i=async()=>{var h;e.marker.getElement().innerHTML=M(e==null?void 0:e.type,b.Initialising);let u=await(await fetch(`${H}/challenges/init`,{method:"POST",body:JSON.stringify({challengeid:e.id,imageid:e.access,username:o.data.user})})).json();a(0,e.state.instanceid=u.status,e),((h=e.state)==null?void 0:h.instanceid)&&e.state.instanceid.length>0&&e.state.instanceid[0]!="i"&&a(1,l="Error when creating EC2 instance..."),d()},d=async()=>{setTimeout(async()=>{let u=await(await fetch(`${H}/challenges`,{method:"POST",body:JSON.stringify({challengeid:e.id,instanceid:e.state.instanceid,username:o.data.user})})).json();u.ip?(a(0,e.state.ip=u.ip,e),e.marker.getElement().innerHTML=M(e==null?void 0:e.type,b.Running)):d()},3e3)},r=async()=>{e.marker.getElement().innerHTML=M(e==null?void 0:e.type,b.Started),await(await fetch(`${H}/challenges/terminate`,{method:"POST",body:JSON.stringify({challengeid:e.id,instanceid:e.state.instanceid,username:o.data.user})})).json(),a(0,e.state.ip="",e),a(0,e.state.instanceid="",e)},m=()=>i(),c=()=>r();return n.$$set=s=>{"challenge"in s&&a(0,e=s.challenge)},[e,l,i,r,m,c]}class gt extends R{constructor(t){super(),F(this,t,rt,it,q,{challenge:0})}}const ot=n=>({}),U=n=>({});function ct(n){let t,a,o,e,l,i;const d=n[3].header,r=L(d,n,n[2],U),m=n[3].default,c=L(m,n,n[2],null);return{c(){t=_("dialog"),a=_("div"),r&&r.c(),o=y(),c&&c.c(),this.h()},l(s){t=v(s,"DIALOG",{class:!0});var u=g(t);a=v(u,"DIV",{class:!0});var h=g(a);r&&r.l(h),o=w(h),c&&c.l(h),h.forEach(p),u.forEach(p),this.h()},h(){z(a,"class","svelte-u6tq7r"),z(t,"class","svelte-u6tq7r")},m(s,u){k(s,t,u),f(t,a),r&&r.m(a,null),f(a,o),c&&c.m(a,null),n[5](t),e=!0,l||(i=[S(a,"click",Q(n[4])),S(t,"close",n[6]),S(t,"click",W(n[7]))],l=!0)},p(s,[u]){r&&r.p&&(!e||u&4)&&A(r,d,s,s[2],e?B(d,s[2],u,ot):C(s[2]),U),c&&c.p&&(!e||u&4)&&A(c,m,s,s[2],e?B(m,s[2],u,null):C(s[2]),null)},i(s){e||(O(r,s),O(c,s),e=!0)},o(s){V(r,s),V(c,s),e=!1},d(s){s&&p(t),r&&r.d(s),c&&c.d(s),n[5](null),l=!1,X(i)}}}function ht(n,t,a){let{$$slots:o={},$$scope:e}=t,{showModal:l}=t,i;function d(s){Y.call(this,n,s)}function r(s){Z[s?"unshift":"push"](()=>{i=s,a(1,i)})}const m=()=>a(0,l=!1),c=()=>{i.close()};return n.$$set=s=>{"showModal"in s&&a(0,l=s.showModal),"$$scope"in s&&a(2,e=s.$$scope)},n.$$.update=()=>{n.$$.dirty&3&&i&&l&&i.showModal()},[l,i,e,o,d,r,m,c]}class zt extends R{constructor(t){super(),F(this,t,ht,ct,q,{showModal:0})}}export{_t as B,gt as D,zt as M,mt as a,H as b,vt as g,pt as u};
